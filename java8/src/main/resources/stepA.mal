(def! *gensym-counter* (atom 0))

(def! gensym (fn* []
  (symbol (str "G__" (swap! *gensym-counter* (fn* [x] (+ 1 x)))))))
  
(defmacro! or (fn* [& xs]
  (if (empty? xs)
    nil
    (if (= 1 (count xs))
      (first xs)
      (let* [condvar (gensym)]
        `(let* [~condvar ~(first xs)]
          (if ~condvar ~condvar (or ~@(rest xs)))))))))